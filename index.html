<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500;700&display=swap" rel="stylesheet">
    <title>2025 Goals Tracker</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Roboto', sans-serif;
    background-color: #121212;
    color: #e0e0e0;
    min-height: 100vh;
    overflow-x: auto;
}

header {
    display: flex;
    position: fixed;
    top: 0;
    left: 0;
    background-color: #1f1f1f;
    color: #e0e0e0;
    padding: 2rem;
    width: 100%;
    height: 6rem;
    text-align: center;
    z-index: 1000;
    border-radius: 0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    justify-content: center;
    align-items: center;
}

h1 {
    font-size: 2.5rem;
    font-weight: 600;
}

.grid {
    display: grid;
    grid-template-columns: 3fr 1fr; 
    gap: 4rem;                       
    margin-top: 6rem;
    padding: 1rem;
}

.container {
    background: #1e1e1e;
    width: 100%; /* Kontener zajmuje 100% dostępnej szerokości */
    max-width: 900px; /* Maksymalna szerokość kontenera */
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    margin: 4rem auto; 
}

.chart-container {
    position: relative;
    width: 250px;
    height: 250px;
    margin-top: 6rem;
    margin-right: 1rem;
}

.chart-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 24px;
    font-weight: bold;
}
.legend {
    margin-top: 1rem;
    max-width: 250px;
    display: flex;
    flex-direction: column;
    gap: 1rem;          
}

.legend-item::before {
    content: "";
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 3px;       
    margin-right: 5px;
}

/* Kolory kwadracików */
.legend-item.done::before {
    background-color: #4CAF50;  /* Zielony dla Done */
}

.legend-item.in-progress::before {
    background-color: #FFA500;  /* Pomarańczowy dla In Progress */
}

.legend-item.all::before {
    background-color: #E0E0E0;  /* Niebieski dla All */
}


.add-goal {
    display: flex;
    gap: 20px;
    justify-content: space-between;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.add-goal input,
.add-goal select {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #333;
    background-color: #2c2c2c;
    color: #e0e0e0;
    width: 45%;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

.add-goal input:focus,
.add-goal select:focus {
    border-color: #4CAF50;
    outline: none;
}

.add-goal button {
    padding: 10px 20px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s ease, transform 0.2s ease;
}

.add-goal button:hover {
    background-color: #45a049;
    transform: translateY(-2px);
}

h2 {
    font-size: 1.5rem;
    margin-bottom: 20px;
    color: #e0e0e0;
    text-transform: uppercase;
    letter-spacing: 1px;
}

ul {
    list-style: none;
    padding: 0;
}

li {
    background-color: #2c2c2c;
    border-radius: 8px;
    margin-bottom: 15px;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
}

li:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    font-weight: bold;
}

li.in-progress {
    background-color: #3e3e2f;
}

.btn-group {
    display: flex;
    gap: 10px;
}

button {
    display: flex;
    font-family: 'Roboto', sans-serif;
    font-size: 0.9rem;
    padding: 6px 15px;
    border-radius: 6px;
    transition: background-color 0.3s ease, transform 0.2s ease;
    justify-content: center;
    align-items: center;
    font-weight: 500;
}

button.done {
    background-color: #4CAF50;
}

button.done:hover {
    background-color: #45a049;
    transform: translateY(-2px);
}

button.delete {
    background-color: #ff4b5c;
}

button.delete:hover {
    background-color: #ff6f72;
    transform: translateY(-2px);
}

button.in-progress {
    background-color: #ff9800;
}

button.in-progress:hover {
    background-color: #ffa726;
    transform: translateY(-2px);
}

button.disabled {
    background-color: #555;
    cursor: not-allowed;
}

.drag-over {
    border: 2px dashed #4CAF50;
    background-color: #2c2c2c;
    transition: background-color 0.3s ease;
}

.completed {
    background-color: #23fb0227;
    color: #abedbb;
}


@media (max-width: 1000px) {
    .grid {
        grid-template-columns: 1fr; 
        gap: 0rem;                  
        padding: 1rem;  
        margin: 2rem;
    }
    .container{
        margin-bottom: 2rem;
    }
    .chart-container {
        margin-top: 0;
    }
}

@media (max-width: 768px) {
    .container {
        padding: 1rem;
    }

    .add-goal {
        flex-direction: column;
        gap: 10px;
    }

    .add-goal input,
    .add-goal select {
        width: 100%;
    }

    .add-goal button {
        width: 100%;
    }

    h1 {
        font-size: 2rem;
    }

    h2 {
        font-size: 1.2rem;
    }
}

@media (max-width: 480px) {
    h1 {
        font-size: 1.8rem;
    }

    .container {
        max-width: 100%;
        padding: 1rem;
    }

    .add-goal input,
    .add-goal select,
    .add-goal button {
        width: 100%;
    }

    ul {
        padding-left: 0;
    }

    li {
        padding: 10px;
    }

    button {
        font-size: 0.8rem;
    }
}
    </style>
</head>
<body>
    <header>
        <h1>2025 Goals Tracker</h1>
    </header>
    <div class="grid">
        <div class="container">
            <div class="add-goal">
                <input type="text" id="goal-input" placeholder="Enter your goal...">
                <select id="goal-category">
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                    <option value="hard">Hard</option>
                </select>
                <button onclick="addGoal()">Add Goal</button>
            </div>

            <h2>Easy Goals</h2>
            <ul id="easy-list"></ul>

            <h2>Medium Goals</h2>
            <ul id="medium-list"></ul>

            <h2>Hard Goals</h2>
            <ul id="hard-list"></ul>
        </div>
        <div class="info-con">
            <div class="chart-container">
                <canvas id="goalChart"></canvas>
                <div class="chart-center" id="chartCenterText">0/0</div>
            </div>
            <div class="legend"> 
                <p class="legend-item done">Done</p>
                <p class="legend-item in-progress">In Progress</p>
                <p class="legend-item all">All</p>
            </div>
        </div>
        
    </div>
    <script>
        function saveGoalsToLocalStorage() {
        localStorage.setItem('goals', JSON.stringify(goals));
    }

    function loadGoalsFromLocalStorage() {
        const storedGoals = localStorage.getItem('goals');
        if (storedGoals) {
            console.log('Loaded goals from localStorage:', JSON.parse(storedGoals)); // Debug
            return JSON.parse(storedGoals);
        }
        return {
            easy: [],
            medium: [],
            hard: []
        };
    }

    const goals = loadGoalsFromLocalStorage();
    let draggedCategory = null;
    let draggedIndex = null;

    function renderGoals() {
        console.log('Rendering goals...'); // Debug
        document.getElementById('easy-list').innerHTML = '';
        document.getElementById('medium-list').innerHTML = '';
        document.getElementById('hard-list').innerHTML = '';

        const countgoals = {
            completed: 0,
            inProgress: 0,
            total: 0
        };

        for (let category in goals) {
            const list = document.getElementById(`${category}-list`);
            if (!list) {
                console.error(`Element ${category}-list not found in DOM!`); // Debug
                continue;
            }

            goals[category].forEach((goalObj, index) => {
                const li = document.createElement('li');
                li.draggable = true;
                li.setAttribute('ondragstart', `dragStart(event, '${category}', ${index})`);
                li.setAttribute('ondragover', `dragOver(event, '${category}', ${index})`);
                li.setAttribute('ondragleave', `dragLeave(event, '${category}', ${index})`);
                li.setAttribute('ondrop', `drop(event, '${category}', ${index})`);

                const goalText = document.createElement('span');
                goalText.textContent = goalObj.goal;
                goalText.title = "Double click to edit";
                goalText.ondblclick = () => startEditing(goalText, category, index);

                if (goalObj.completed) {
                    li.classList.add('completed');
                    countgoals.completed++;
                } else if (goalObj.inProgress) {
                    li.classList.add('in-progress');
                    countgoals.inProgress++;
                }

                countgoals.total++;

                const btnGroup = document.createElement('div');
                btnGroup.classList.add('btn-group');

                const doneButton = document.createElement('button');
                doneButton.classList.add('done');
                doneButton.textContent = '✔ Done';
                doneButton.onclick = () => toggleComplete(doneButton, category, index);

                const inProgressButton = document.createElement('button');
                inProgressButton.classList.add('in-progress');
                inProgressButton.textContent = '⧗ In Progress';
                inProgressButton.onclick = () => toggleInProgress(inProgressButton, category, index);

                const deleteButton = document.createElement('button');
                deleteButton.classList.add('delete');
                deleteButton.textContent = '✖ Delete';
                deleteButton.onclick = () => deleteGoal(category, index);

                btnGroup.appendChild(doneButton);
                btnGroup.appendChild(inProgressButton);
                btnGroup.appendChild(deleteButton);

                li.appendChild(goalText);
                li.appendChild(btnGroup);
                list.appendChild(li);

                if (goalObj.completed) {
                    doneButton.classList.add('disabled');
                    doneButton.disabled = true;
                    inProgressButton.classList.add('disabled');
                    inProgressButton.disabled = true;
                } else if (goalObj.inProgress) {
                    inProgressButton.classList.add('active');
                    doneButton.classList.remove('disabled');
                    doneButton.disabled = false;
                } else {
                    doneButton.classList.remove('disabled');
                    doneButton.disabled = false;
                    inProgressButton.classList.remove('disabled');
                    inProgressButton.disabled = false;
                }
            });
        }

        console.log('Ukończone cele:', countgoals.completed);
        console.log('Cele w trakcie:', countgoals.inProgress);
        console.log('Łączna liczba celów:', countgoals.total);

        // Obliczanie pozostałych celów
            const remaining = countgoals.total - (countgoals.completed + countgoals.inProgress);

        // Tworzenie lub aktualizacja wykresu
        const ctx = document.getElementById('goalChart').getContext('2d');

        // Jeśli wykres już istnieje, zniszcz go przed utworzeniem nowego
        if (window.goalChart && typeof window.goalChart.destroy === 'function') {
            window.goalChart.destroy();
        }

        window.goalChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [countgoals.inProgress, countgoals.completed, remaining],
                    backgroundColor: ['#FFA500', '#4CAF50', '#E0E0E0'],
                    borderWidth: 0
                }]
            },
            options: {
                cutout: '70%',
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: false
                    }
                }
            }
        });

        // Aktualizacja tekstu w środku wykresu
        document.getElementById('chartCenterText').innerText = `${countgoals.completed}/${countgoals.total}`;
    }
        
        function startEditing(goalText, category, index) {
            const input = document.createElement('input');
            input.type = 'text';
            input.value = goalText.textContent;
            input.style.backgroundColor = '#2c2c2c';
            input.style.color = '#e0e0e0';
            input.style.border = '1px solid #333';
            input.style.borderRadius = '8px';
            input.style.padding = '5px';
            input.style.fontSize = '1rem';
            input.style.width = '50%';
        
            input.addEventListener('blur', () => saveEdit(input, goalText, category, index));
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    saveEdit(input, goalText, category, index);
                }
            });
        
            goalText.parentElement.replaceChild(input, goalText);
            input.focus();
        }
        
        function saveEdit(input, goalText, category, index) {
            goals[category][index].goal = input.value.trim();
            goalText.textContent = input.value.trim();
            input.parentElement.replaceChild(goalText, input);
        
            saveGoalsToLocalStorage();
            renderGoals();
        }
        
        function addGoal() {
            const inputElement = document.getElementById('goal-input');
            const categoryElement = document.getElementById('goal-category');
            
            const newGoal = inputElement.value.trim();
            const category = categoryElement.value;
        
            if (!newGoal) {
                alert('Please enter a goal!');
                return;
            }
        
            goals[category].push({ goal: newGoal, completed: false, inProgress: false });
            inputElement.value = ''; 
        
            saveGoalsToLocalStorage();
            renderGoals();
        }
        
        document.getElementById('goal-input').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                addGoal();
            }
        });
        
        function dragStart(event, category, index) {
            draggedCategory = category;
            draggedIndex = index;
            event.dataTransfer.effectAllowed = 'move';
        }
        
        function dragOver(event, category, index) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
        
            const list = document.getElementById(`${category}-list`);
            const items = list.children;
            if (items[index]) {
                items[index].classList.add('drag-over');
            }
        }
        
        function dragLeave(event, category, index) {
            const list = document.getElementById(`${category}-list`);
            const items = list.children;
            if (items[index]) {
                items[index].classList.remove('drag-over');
            }
        }
        
        function drop(event, targetCategory, targetIndex) {
            event.preventDefault();
        
            if (draggedCategory === null || draggedIndex === null) return;
        
            const draggedGoal = goals[draggedCategory][draggedIndex];
            goals[draggedCategory].splice(draggedIndex, 1);
        
            if (targetIndex >= goals[targetCategory].length) {
                goals[targetCategory].push(draggedGoal);
            } else {
                goals[targetCategory].splice(targetIndex, 0, draggedGoal);
            }
        
            draggedCategory = null;
            draggedIndex = null;
        
            saveGoalsToLocalStorage();
            renderGoals();
        }
        
        function toggleComplete(button, category, index) {
            const list = document.getElementById(`${category}-list`);
            const item = list.children[index];
        
            goals[category][index].completed = true;
            goals[category][index].inProgress = false;  // Jeśli cel jest zakończony, to nie jest już w trakcie realizacji
            item.classList.add('completed');
            item.classList.remove('in-progress');
        
            const doneButton = item.querySelector('.done');
            const inProgressButton = item.querySelector('.in-progress');
        
            doneButton.classList.add('disabled');
            doneButton.disabled = true;
            inProgressButton.classList.add('disabled');
            inProgressButton.disabled = true;
        
            saveGoalsToLocalStorage();
            renderGoals();
        }
        
        function toggleInProgress(button, category, index) {
            const list = document.getElementById(`${category}-list`);
            const item = list.children[index];
        
            // Zmieniamy status inProgress
            goals[category][index].inProgress = !goals[category][index].inProgress;
        
            if (goals[category][index].inProgress) {
                // Jeśli cel jest w trakcie realizacji, usuwamy klasę 'completed' i dodajemy 'in-progress'
                item.classList.remove('completed');
                item.classList.add('in-progress');
            } else {
                // Jeśli cel nie jest w trakcie realizacji, sprawdzamy, czy jest zakończony
                if (goals[category][index].completed) {
                    // Jeśli jest zakończony, dodajemy 'completed'
                    item.classList.add('completed');
                    item.classList.remove('in-progress');
                } else {
                    // Jeśli nie jest ani zakończony, ani w trakcie realizacji, przywracamy kolor szary
                    item.classList.remove('completed');
                    item.classList.remove('in-progress');
                }
            }
        
            saveGoalsToLocalStorage();
            renderGoals();
        }
        
        
        function deleteGoal(category, index) {
            goals[category].splice(index, 1);
            saveGoalsToLocalStorage();
            renderGoals();
        }
        
        renderGoals();
        
    </script>
    

</body>
</html>
